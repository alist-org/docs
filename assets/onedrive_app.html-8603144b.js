import{_,a as v,b as k,c as h,d as b,e as g,f,g as x,h as y,i as A}from"./onedrive_app_user-d7abb45b.js";import{_ as I,r as l,o as D,c as E,b as n,e as s,a as e,w as i,f as r}from"./app-ff454395.js";const R={},P=r('<h1 id="onedrive-app" tabindex="-1"><a class="header-anchor" href="#onedrive-app" aria-hidden="true">#</a> OneDrive APP</h1><h2 id="好处以及注意事项" tabindex="-1"><a class="header-anchor" href="#好处以及注意事项" aria-hidden="true">#</a> <strong>好处以及注意事项</strong></h2><ol><li><p>好处是只授权一次管理员登录，后续添加参数时用一样的，在添加时除了邮箱哪里不同，别的都一样</p><ul><li>例如E5 25个5T的账号，你提前登录初始化完毕后，直接CV之前的参数即可，不用像以前一样每次都得去获取刷新令牌时间一长还失效</li><li>A1 A1P等可以分发的账号更多(500 - <strong>无限</strong>)</li></ul></li><li><p>这样的方式管理员授权后，可以随意查看组织中每个成员的账号，泄露了自己的文件</p><ul><li>建议自己申请 OneDrive E5 去好一些</li></ul></li></ol><hr><div class="hint-container tip"><p class="hint-container-title">提示</p><p>不适用于家庭版，如果你在配置过程中，与教程中出现的选项不符可能是不支持</p></div><p>首先使用个人或者组织账号登录</p>',6),K={href:"https://entra.microsoft.com/#view/Microsoft_AAD_IAM/TenantOverview.ReactView?Microsoft_AAD_IAM_legacyAADRedirect=true",target:"_blank",rel:"noopener noreferrer"},M=r('<p><img src="'+_+'" alt="onedriveapp"></p><h2 id="新建过程" tabindex="-1"><a class="header-anchor" href="#新建过程" aria-hidden="true">#</a> <strong>新建过程</strong></h2><div class="hint-container danger"><p class="hint-container-title">请仔细阅读注意事项</p><p>请仔细阅读下面的 <strong><code>序号，依次查看</code></strong> ，如有错误可及时反馈</p></div>',3),B=n("li",null,[n("p",null,"注册一个应用，类型自己选，建议选第三吧")],-1),C={href:"https://entra.microsoft.com/TokenAuthorize",target:"_blank",rel:"noopener noreferrer"},T=n("p",null,[n("img",{src:v,alt:"onedriveapp"})],-1),S=n("p",null,[n("img",{src:k,alt:"onedriveapp"})],-1),w=n("p",null,[s("客户端秘钥拿到了，去授权一下使用的 "),n("strong",null,[n("code",null,"API")]),s("，依旧跟着下图获取即可")],-1),L=n("p",null,[n("img",{src:h,alt:"onedriveapp"})],-1),q=n("p",null,"API授权后，我们去授权组织应用",-1),z=n("ul",null,[n("li",null,[s("左侧侧边栏 ---> 企业应用程序 ---> 所有应用程序 ---> "),n("strong",null,"{选择我们开始新建的哪个应用名称}"),s(" ---> 权限 ---> 点击 代表"),n("code",null,"xxxx"),s("授予管理员同意")])],-1),O=n("p",null,[n("img",{src:b,alt:"onedriveapp"})],-1),U=n("p",null,"注意事项",-1),N=n("ul",null,[n("li",null,"如果你在开始注册应用时，回调参数不是一样的可能点击授权时会报错，记得写一样的"),n("li",null,[s("如何查看是否授权成功，未授权时页面是提示"),n("code",null,"未发现该应用程序具有管理员许可的授权"),s("，授权成功后刷新一下页面会看到三条API权限如下图所示 "),n("ul",null,[n("li",null,"上面是未授权时的样子，下面是授权后的样子（授权后刷新页面即可）")])])],-1),F=n("p",null,[n("img",{src:g,alt:"onedriveapp"})],-1),V=n("p",null,[s("通过开始到现在 我们分别拿到了如下参数：租户ID"),n("sup",null,"1"),s("，注册应用"),n("sup",null,"2"),s("，拿到客户端ID/秘钥"),n("sup",null,"3"),s("，授权API/管理员API"),n("sup",null,"4")],-1),W=n("div",{class:"language-html line-numbers-mode","data-ext":"html"},[n("pre",{class:"language-html"},[n("code",null,`https://login.microsoftonline.com/{租户ID或者common}/adminConsent?client_id={客户端ID}&redirect_uri={注册应用时的回调URL}
`)]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"})])],-1),Q=n("p",null,[n("img",{src:f,alt:"onedriveapp"})],-1),G=n("p",null,"如果你按照拼写好后的链接也登录了发现跳转到了一个空白页面，例如下面示例代码和图片中的就是授权成功了不用担心",-1),J=n("div",{class:"language-text line-numbers-mode","data-ext":"text"},[n("pre",{class:"language-text"},[n("code",null,`https://entra.microsoft.com/TokenAuthorize?admin_consent=True&tenant={租户ID}#
`)]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"})])],-1),H=n("p",null,[n("img",{src:x,alt:"onedriveapp"})],-1),Z=n("h2",{id:"填写示例",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#填写示例","aria-hidden":"true"},"#"),s(),n("strong",null,"填写示例")],-1),Y=n("p",null,[s("将上述过程中获取得到的值依次填入即可，如果哪个邮箱你不知道是什么了 可以通过"),n("a",{href:"#%E6%9F%A5%E7%9C%8B%E7%BB%84%E7%BB%87%E6%89%80%E6%9C%89%E7%94%A8%E6%88%B7"},[n("strong",null,"查看组织所有用户")]),s("来查找")],-1),X=n("p",null,[n("img",{src:y,alt:"onedriveapp"})],-1),j=n("h2",{id:"查看组织所有用户",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#查看组织所有用户","aria-hidden":"true"},"#"),s(),n("strong",null,"查看组织所有用户")],-1),$=n("p",null,[s("如果不知道自己的OneDrive组织有多少用户可以前往下面的链接登录 "),n("code",null,"admin"),s("账号查看")],-1),nn={href:"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/users",target:"_blank",rel:"noopener noreferrer"},sn=n("p",null,[n("img",{src:A,alt:"onedriveapp"})],-1),en=n("h2",{id:"错误提示",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#错误提示","aria-hidden":"true"},"#"),s(),n("strong",null,"错误提示")],-1),an=n("ul",null,[n("li",null,[s("提示："),n("strong",null,"Either scp or roles claim need to be present in the token"),s(" 错误")])],-1),tn=n("code",null,"4",-1),ln=n("ul",null,[n("li",null,[s("提示："),n("strong",null,"failed get objs: failed to list objs: Unable to retrieve user's mysite URL"),s(" 错误")])],-1),on=n("code",null,"OneDrive",-1),cn={href:"https://github.com/alist-org/docs/discussions/189#discussioncomment-5928892",target:"_blank",rel:"noopener noreferrer"},pn=n("strong",null,"案例",-1),rn=n("h2",{id:"批量添加onedrive-app账号",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#批量添加onedrive-app账号","aria-hidden":"true"},"#"),s(),n("strong",null,"批量添加OneDrive_App账号")],-1),un={href:"https://github.com/yzbtdiy/alist_batch",target:"_blank",rel:"noopener noreferrer"},dn=r(`<details class="hint-container details"><summary>参数填写，看不懂可以看下方的视频</summary><p>两个配置文件不要留空白空行哦，那样也会报错的</p><p><strong>config.yaml</strong></p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># 自己的AList站点，可以是本地也可以是远程服务器IP或者域名，但是结尾不能带 &quot;/&quot;</span>
<span class="token key atrule">url</span><span class="token punctuation">:</span> ALIST_URL
<span class="token comment"># auth的三个参数是你AList管理员账号密码和刷新令牌</span>
<span class="token key atrule">auth</span><span class="token punctuation">:</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> USERNAME
    <span class="token key atrule">password</span><span class="token punctuation">:</span> PASSWORD
<span class="token key atrule">token</span><span class="token punctuation">:</span> ALIST_TOKEN
<span class="token comment"># enable选项你需要哪个就开启哪个，不需要的关闭</span>
<span class="token key atrule">aliyun</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">refresh_token</span><span class="token punctuation">:</span> ALI_YUNPAN_REFRESH_TOKEN
<span class="token key atrule">pikpak</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> PIKPAK_EMAIL
    <span class="token key atrule">password</span><span class="token punctuation">:</span> PIKPAK_PASSWORD
<span class="token comment"># 我们这里需要的是 onedrive_app，把这个开启</span>
<span class="token key atrule">onedrive_app</span><span class="token punctuation">:</span>
    <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token comment"># global是全局例如E5 A1 A1P, 世纪互联是cn 德国版是de 美国版是us</span>
    <span class="token key atrule">region</span><span class="token punctuation">:</span> global
    <span class="token key atrule">tenants</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">1</span>
          <span class="token key atrule">client_id</span><span class="token punctuation">:</span> 客户端ID
          <span class="token key atrule">client_secret</span><span class="token punctuation">:</span> 客户端秘钥
          <span class="token key atrule">tenant_id</span><span class="token punctuation">:</span> 租户ID
<span class="token comment"># 这里可以同时挂载不同域和不同账号，每个域照着上面的配置写即可</span>
<span class="token comment"># 客户端ID 客户端秘钥 租户ID 就不用说了吧？</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>onedrive_app.yaml</strong></p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># 分类1 挂载x 可以自己随便改，相当于添加存储时候的挂载路径</span>
<span class="token comment"># 1 这里指的是要使用上面配置文件里面的哪个域/组织的配置</span>
<span class="token comment"># 后面的就是自己的邮箱账号啦~如果不写 &quot;:/folder1&quot;,挂载的是根目录 写了就是挂载这个目录</span>
<span class="token comment"># 反正格式就是： 挂载路径:域/组织:邮箱账号:/文件夹目录(可选)</span>
<span class="token key atrule">分类1</span><span class="token punctuation">:</span>
    <span class="token key atrule">挂载1</span><span class="token punctuation">:</span> 1<span class="token punctuation">:</span>user1@xxx.onmicrosoft.com
    <span class="token key atrule">挂载2</span><span class="token punctuation">:</span> 1<span class="token punctuation">:</span>user2@xxx.onmicrosoft.com<span class="token punctuation">:</span>/folder1
    <span class="token key atrule">挂载3</span><span class="token punctuation">:</span> 1<span class="token punctuation">:</span>user2@xxx.onmicrosoft.com<span class="token punctuation">:</span>/folder2
<span class="token comment"># 你可以分多个不同的列表挂载也行，照着格式写</span>
<span class="token key atrule">分类2</span><span class="token punctuation">:</span>
    <span class="token key atrule">挂载11</span><span class="token punctuation">:</span> 1<span class="token punctuation">:</span>user1@xxx.onmicrosoft.com
    <span class="token key atrule">挂载22</span><span class="token punctuation">:</span> 1<span class="token punctuation">:</span>user2@xxx.onmicrosoft.com<span class="token punctuation">:</span>/folder1
    <span class="token key atrule">挂载33</span><span class="token punctuation">:</span> 1<span class="token punctuation">:</span>user2@xxx.onmicrosoft.com<span class="token punctuation">:</span>/folder2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details>`,1),mn=n("h3",{id:"默认使用的下载方式",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#默认使用的下载方式","aria-hidden":"true"},"#"),s(),n("strong",null,"默认使用的下载方式")],-1);function _n(vn,kn){const t=l("ExternalLinkIcon"),a=l("Badge"),d=l("Tabs"),u=l("BiliBili"),m=l("Mermaid");return D(),E("div",null,[P,n("p",null,[n("strong",null,[n("a",K,[s("https://entra.microsoft.com/#view/Microsoft_AAD_IAM/TenantOverview.ReactView?Microsoft_AAD_IAM_legacyAADRedirect=true"),e(t)])])]),n("p",null,[s("登录后获取我们的"),e(a,{text:"租户ID",type:"info",vertical:"middle"})]),M,e(d,{id:"63",data:[{title:"1"},{title:"2"},{title:"3"},{title:"4"},{title:"5"}],"tab-id":"onedrive_app"},{tab0:i(({title:o,value:c,isActive:p})=>[n("ol",null,[B,n("li",null,[n("p",null,[s("重定向URL(回调参数)，类型选择Web，参数填写： "),n("strong",null,[n("a",C,[s("https://entra.microsoft.com/TokenAuthorize"),e(t)])]),s(" ，否则后面授权时无法授权")])]),n("li",null,[n("p",null,[s("填好后点击下方的注册 跳转后就可以看到"),e(a,{text:"客户端ID",type:"info",vertical:"middle"})])])]),T]),tab1:i(({title:o,value:c,isActive:p})=>[n("p",null,[s("我们去获取一个客户端秘钥，按照下图获取即可，记得"),e(a,{text:"客户端秘钥",type:"info",vertical:"middle"}),s("要及时保存，只会出现一次")]),S]),tab2:i(({title:o,value:c,isActive:p})=>[w,L]),tab3:i(({title:o,value:c,isActive:p})=>[q,z,O,U,N,F]),tab4:i(({title:o,value:c,isActive:p})=>[V,n("p",null,[s("然后通过下面的格式最终授权一下即可，分别是"),e(a,{text:"租户ID",type:"info",vertical:"middle"}),e(a,{text:"客户端ID",type:"info",vertical:"middle"}),e(a,{text:"回调参数URL",type:"info",vertical:"middle"}),s("改成自己的最终登录收取即可")]),W,Q,G,J,H]),_:1}),Z,Y,X,e(u,{bvid:"BV1Ro4y1s725",ratio:"16:9","low-quality":"","no-danmaku":""}),j,$,n("p",null,[n("strong",null,[n("a",nn,[s("https://admin.microsoft.com/Adminportal/Home?source=applauncher#/users"),e(t)])])]),sn,en,an,n("p",null,[s("是因为你没有在第"),tn,s("步的时候进行 "),e(a,{text:"代表xxxx授予管理员同意",type:"info",vertical:"middle"}),s(" 导致的，注意查看第四步下面的提示")]),ln,n("p",null,[s("新建的 "),on,s("用户账号不是实时生效，会延时生效等待几小时后试试看 "),n("a",cn,[pn,e(t)])]),rn,n("p",null,[s("使用的软件："),n("strong",null,[n("a",un,[s("https://github.com/yzbtdiy/alist_batch"),e(t)])])]),dn,e(u,{bvid:"BV1vc411V78S",ratio:"16:9","low-quality":"","no-danmaku":""}),mn,e(m,{id:"mermaid-232",code:"eJzT1dXlKsksyUm1Uni5e8aLdUue7N3/fMqK57Nank5e9Xx575Md3S/27n02befTPf3v98znAqlPy8kvT85ILCpRCHHiUgCC4pLKnFSFREOFtMycHCvlpKQ0neKSovzsVCvlNDMzKFu3PDOlJMPKqKBCJzk/J78IKJeWhqzdCKo9Lc3c1NwUboKxsTGqCSYFFRBtpUnpRYkFGQqZKamGCtEKsWDRREMwlZqXAuVGGxsYxVpZWRXn56Ym5yQWF9sCQQ3EszWJRtFA3z7r2P5i3b6nS9ohRoBVuaSmKcC1wFxmaQZRYBj9bM6aZ3N2Pdm9+PmEtlhdPaDelw2derp2WA1MMoyGqAwN8iGoODknMzkbFJhKenr6KUWZZalFxfrJ+bm5+Xl6GSW5OcrlqUkpiWW6z9dOez51qRKSniQy9CQTrQcAkHnb9A=="})])}const gn=I(R,[["render",_n],["__file","onedrive_app.html.vue"]]);export{gn as default};
